<p-confirmDialog/>
<p-toast></p-toast>

<app-menu></app-menu>

<main class="shadow-1 border-round-md my-5 p-3">
  <p-toolbar class="w-full p-0 mt-3">
    <div class=" p-toolbar-group-right">
      <p>Formulário de {{ rotaAtual == 'novo' ? 'Cadastro' : 'Edição' }} de Locais</p>
    </div>
  </p-toolbar>

  <form class="flex flex-column gap-3 mt-3">
    <div class="flex flex-column gap-2">
      <label for="nome">Nome do Local</label>
      <input
        pInputText
        id="nome"
        [(ngModel)]="form.nome"
        name="nome"
        maxlength="255"
      />
      <small>
        {{ form.nome.length }} / 255
      </small>
    </div>

    <div class="flex flex-column gap-2">
      @for (medicao of this.form.medicoes; track $index) {
        <p-fieldset class="mt-3 flex flex-column align-content-center gap-3"  legend="Medicao #{{$index + 1}}" [toggleable]="true">
          <div class="flex flex-column gap-2">
            <label for="data-{{medicao.data}}">Data</label>

            <p-calendar
              [showIcon]="true"
              [(ngModel)]="medicao.data"
              id="data-{{medicao.data}}"
              name="data-{{medicao.data}}"
              dateFormat="dd/mm/yy"
            ></p-calendar>
          </div>

          <div class="flex flex-column gap-2">
            <label for="nivel_sinal_24ghz">Nível de Sinal 2.4GHz</label>
            <input
              pInputText
              id="nivel_sinal_24ghz"
              [(ngModel)]="medicao.nivel_sinal_24ghz"
              name="nivel_sinal_24ghz-{{medicao.nivel_sinal_24ghz}}"
              type="number"
            />
          </div>

          <div class="flex flex-column gap-2">
            <label for="nivel_sinal_5ghz">Nível de Sinal 5GHz</label>
            <input
              pInputText
              id="nivel_sinal_5ghz"
              [(ngModel)]="medicao.nivel_sinal_5ghz"
              name="nivel_sinal_5ghz-{{medicao.nivel_sinal_5ghz}}"
              type="number"
            />
          </div>

          <div class="flex flex-column gap-2">
            <label for="velocidade_24ghz">Velocidade 2.4GHz</label>
            <input
              pInputText
              id="velocidade_24ghz"
              [(ngModel)]="medicao.velocidade_24ghz"
              name="velocidade_24ghz-{{medicao.velocidade_24ghz}}"
              type="number"
            />
          </div>

          <div class="flex flex-column gap-2">
            <label for="velocidade_5ghz">Velocidade 5GHz</label>
            <input
              pInputText
              id="velocidade_5ghz"
              [(ngModel)]="medicao.velocidade_5ghz"
              name="velocidade_5ghz--{{medicao.velocidade_5ghz}}"
              type="number"
            />
          </div>

          <div class="flex flex-column gap-2">
            <label for="interferencia">Interferência</label>
            <input
              pInputText
              id="interferencia"
              [(ngModel)]="medicao.interferencia"
              name="interferencia-{{medicao.interferencia}}"
              type="number"
            />
          </div>

          <div class="flex justify-content-end align-content-center w-full mt-2 gap-2">
            <p-button
              type="button"
              label="Remover"
              [outlined]="true"
              raised
              severity="danger"
              (click)="removerMedicao($index, medicao)"
            />
          </div>

        </p-fieldset>

      }
      <p-button
        type="button"
        label="Adicionar medição"
        [outlined]="true"
        severity="success"
        (click)="adicionarMedicao()"
      />
    </div>

    <p-toolbar class="w-full p-0 mt-3">
      <div class=" p-toolbar-group-left">
      </div>
      <div class=" p-toolbar-group-right">
        <div class="flex justify-content-end align-items-center gap-2">
          <p-button
            type="button"
            label="Cancelar"
            severity="secondary"
            (click)="voltar()"
          />

          <p-button
            type="submit"
            label="Salvar"
            severity="success"
            (click)="salvar()"
          />
        </div>      </div>
    </p-toolbar>


  </form>
</main>
